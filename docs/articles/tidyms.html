<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A Grammar of Data Manipulation for Quantitative Proteomics • tidyms</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">tidyms</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/lgatto/tidyms">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>A Grammar of Data Manipulation for Quantitative Proteomics</h1>
                        <h4 class="author">Laurent Gatto</h4>
            
          </div>

    
    
<div class="contents">
<pre><code>## Warning: replacing previous import 'MSnbase::combine' by 'dplyr::combine'
## when loading 'tidyms'</code></pre>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The <code>tidyms</code> package implements tidy principles as defined in the <a href="https://www.tidyverse.org/">tidyverse</a> packages to omics-type data classes, with (currently at least), an emphasis on quantitative proteomics data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"tidyms"</span>)</code></pre></div>
</div>
<div id="examples" class="section level1">
<h1 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h1>
<p>For all examples, we’ll make use of the <code>msnset</code> object that comes with the MSnbase package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"MSnbase"</span>)
<span class="kw">data</span>(msnset)

## Some test sample groups
msnset<span class="op">$</span>group &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>)</code></pre></div>
<div id="order-data-by-it-feature-of-sample-variables" class="section level2">
<h2 class="hasAnchor">
<a href="#order-data-by-it-feature-of-sample-variables" class="anchor"></a>Order data by it feature of sample variables</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Arrange columns/samples
msnset <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">arrange</span>(<span class="kw">desc</span>(group)) <span class="op">%&gt;%</span>
<span class="st">    </span>pData</code></pre></div>
<pre><code>##               mz reporters group
## iTRAQ4.116 116.1    iTRAQ4     B
## iTRAQ4.117 117.1    iTRAQ4     B
## iTRAQ4.114 114.1    iTRAQ4     A
## iTRAQ4.115 115.1    iTRAQ4     A</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## All feature variables
<span class="kw">fvarLabels</span>(msnset)</code></pre></div>
<pre><code>##  [1] "spectrum"            "ProteinAccession"    "ProteinDescription" 
##  [4] "PeptideSequence"     "file"                "retention.time"     
##  [7] "precursor.mz"        "precursor.intensity" "charge"             
## [10] "peaks.count"         "tic"                 "ionCount"           
## [13] "ms.level"            "acquisition.number"  "collision.energy"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Select a feature variable
msnset <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">select</span>(charge) <span class="op">%&gt;%</span>
<span class="st">    </span>fvarLabels</code></pre></div>
<pre><code>## [1] "charge"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Arrange rows/features and select feature variables
msnset <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">arrange</span>(charge) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">select</span>(charge) <span class="op">%&gt;%</span>
<span class="st">    </span>fData <span class="op">%&gt;%</span><span class="st"> </span>head</code></pre></div>
<pre><code>##     charge
## X1       2
## X11      2
## X12      2
## X13      2
## X14      2
## X16      2</code></pre>
</div>
<div id="return-features-and-samples-with-matching-conditions" class="section level2">
<h2 class="hasAnchor">
<a href="#return-features-and-samples-with-matching-conditions" class="anchor"></a>Return features and samples with matching conditions</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Filter using feature variables
msnset <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter</span>(ProteinAccession <span class="op">==</span><span class="st"> "ENO"</span>) <span class="op">%&gt;%</span>
<span class="st">    </span>exprs</code></pre></div>
<pre><code>##       iTRAQ4.114  iTRAQ4.115  iTRAQ4.116  iTRAQ4.117
## X27 147093.25030 94770.28613 42616.07457 21259.42497
## X46   5369.73246  1148.32171          NA  1313.44599
## X47   7384.83022  3935.30012  2370.02527  1115.75006
## X55     15.11764    15.68074    14.23333    14.03018</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Filter using phenotypic (samples) variables
msnset <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter</span>(group <span class="op">==</span><span class="st"> "A"</span>) <span class="op">%&gt;%</span>
<span class="st">    </span>exprs <span class="op">%&gt;%</span>
<span class="st">    </span>head</code></pre></div>
<pre><code>##     iTRAQ4.114 iTRAQ4.115
## X1   1347.6158  2247.3097
## X10   739.9861   799.3501
## X11 27638.3582 33394.0252
## X12 31892.8928 33634.6980
## X13 26143.7542 29677.4781
## X14  6448.0829  6234.1957</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Filter on both feature and sample variables
msnset <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter</span>(group <span class="op">==</span><span class="st"> "A"</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter</span>(ProteinAccession <span class="op">==</span><span class="st"> "ENO"</span>) <span class="op">%&gt;%</span>
<span class="st">    </span>exprs</code></pre></div>
<pre><code>##       iTRAQ4.114  iTRAQ4.115
## X27 147093.25030 94770.28613
## X46   5369.73246  1148.32171
## X47   7384.83022  3935.30012
## X55     15.11764    15.68074</code></pre>
</div>
<div id="group-by-one-or-more-feature-or-sample-variables" class="section level2">
<h2 class="hasAnchor">
<a href="#group-by-one-or-more-feature-or-sample-variables" class="anchor"></a>Group by one or more feature or sample variables</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Group by features
msnset <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(ProteinAccession)</code></pre></div>
<pre><code>## # A tibble: 55 x 4
## # Groups:   [?]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Group by samples
msnset <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(group)</code></pre></div>
<pre><code>## # A tibble: 55 x 4
## # Groups:   [?]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Group by features and samples
msnset <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(ProteinAccession) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(group)</code></pre></div>
<pre><code>## # A tibble: 55 x 4
## # Groups:   [?]</code></pre>
</div>
<div id="select-feature-or-sample-variables" class="section level2">
<h2 class="hasAnchor">
<a href="#select-feature-or-sample-variables" class="anchor"></a>Select feature or sample variables</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Select sample variables (updates only the phenotypic data)
msnset <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">select</span>(group) <span class="op">%&gt;%</span>
<span class="st">    </span>pData</code></pre></div>
<pre><code>##            group
## iTRAQ4.114     A
## iTRAQ4.115     A
## iTRAQ4.116     B
## iTRAQ4.117     B</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Select feature variables (updates only the feature data)
msnset <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">"Protein"</span>)) <span class="op">%&gt;%</span>
<span class="st">    </span>fvarLabels</code></pre></div>
<pre><code>## [1] "ProteinAccession"   "ProteinDescription"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Select sample and feature variables
msnset <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">select</span>(group) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">"Prot"</span>))</code></pre></div>
<pre><code>## MSnSet (storageMode: lockedEnvironment)
## assayData: 55 features, 4 samples 
##   element names: exprs 
## protocolData: none
## phenoData
##   sampleNames: iTRAQ4.114 iTRAQ4.115 iTRAQ4.116 iTRAQ4.117
##   varLabels: group
##   varMetadata: labelDescription
## featureData
##   featureNames: X1 X10 ... X9 (55 total)
##   fvarLabels: ProteinAccession ProteinDescription
##   fvarMetadata: labelDescription
## experimentData: use 'experimentData(object)'
## Annotation: No annotation 
## - - - Processing information - - -
## Data loaded: Wed May 11 18:54:39 2011 
## iTRAQ4 quantification by trapezoidation: Wed Apr  1 21:41:53 2015 
##  MSnbase version: 1.1.22</code></pre>
</div>
<div id="summarise-the-expression-values-of-a-dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#summarise-the-expression-values-of-a-dataset" class="anchor"></a>Summarise the expression values of a dataset</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Grouping and summarising by features
msnset <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(charge) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">summarise</span>(<span class="kw">median</span>(exprs, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span>exprs</code></pre></div>
<pre><code>##   iTRAQ4.114 iTRAQ4.115 iTRAQ4.116 iTRAQ4.117
## 2  6916.4565   6099.295   6436.630   7715.448
## 3   982.4017   1119.316   1048.691   1175.080</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">msnset <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(ProteinAccession) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">summarise</span>(<span class="kw">median</span>(exprs, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span>exprs</code></pre></div>
<pre><code>##         iTRAQ4.114 iTRAQ4.115 iTRAQ4.116 iTRAQ4.117
## BSA      1347.6158  2247.3097  3927.6931  7661.1463
## ECA0172 17593.5476 18545.6197 19361.8367 18328.2365
## ECA0435  4923.6281  5557.8180  5775.2025  5079.2952
## ECA0452  1524.1477  1399.8969  1547.2185  1563.2299
## ECA0469  1069.9446  1035.6888  1029.4199   999.6957
## ECA0621  1101.0620  1124.1671  1140.0931  1191.8055
## ECA0631  5852.6654  5964.3946  5970.3694  6006.8593
## ECA0691   760.0320   866.4404   883.9100   791.3296
## ECA0871  6448.0829  6234.1957  6902.8903  6437.2303
## ECA0978  2278.3661  2570.0800  2785.5656  2446.7990
## ECA1032 32838.0439 37066.0578 41429.6267 39700.4752
## ECA1093  5135.5601  5519.0533  5828.3708  5583.7295
## ECA1104 21262.1475 23168.7291 25407.0685 25949.9540
## ECA1294  3715.0893  4254.3226  4748.4615  5249.9036
## ECA1362  4483.3199  4873.9961  6743.4406  4601.3776
## ECA1363  1147.0380  1281.2586  1278.7010  1175.0804
## ECA1364 26143.7542 29677.4781 29089.0593 27902.5608
## ECA1422   739.9861   799.3501   712.5983   940.6793
## ECA1443  2770.3769  2907.2221  3055.5165  2946.7997
## ECA2186  2092.4763  1993.8795  2371.3424  2620.8566
## ECA2391 30047.2436 31498.2176 38489.8088 38275.2637
## ECA2421 11947.8808 13061.8750 12809.4914 12911.4785
## ECA2831  1259.1890  1448.3734  1653.7490  1261.5245
## ECA3082  4458.7717  4786.5183  4350.7847  4303.0256
## ECA3175  3824.3562  3746.2674  4285.0212  3649.4442
## ECA3349  2502.7792  3013.0427  3017.5382  2996.3127
## ECA3356  8635.3165 10036.5291  9254.4317  7769.7491
## ECA3377  3086.4498  3266.4194  4093.8033  3905.6241
## ECA3566  6670.6942  7141.7254  7091.1509  6779.9994
## ECA3882 31892.8928 33634.6980 37674.7272 37227.7119
## ECA3929  8504.4817  9924.0705 10058.2660  9611.8645
## ECA3969  2800.3956  3244.9775  2965.3188  3184.1939
## ECA4013  7540.6373  7679.1576  7561.9833  8005.1765
## ECA4026  1098.2095   984.6451  1236.1929  1173.1222
## ECA4030 27638.3582 33394.0252 32104.2879 26628.7278
## ECA4037  1566.7477  1444.2795  1455.8966  1557.1990
## ECA4512   722.2982  1058.8712   851.4702   944.6287
## ECA4513 10154.9533 10486.9427 11018.1912 11289.5520
## ECA4514  6760.4024  7428.0749  7332.9639  6972.3753
## ENO      6377.2813  2541.8109  2370.0253  1214.5980</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Grouping and summarising by samples
msnset <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(group) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">summarise</span>(<span class="kw">mean</span>(exprs, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span>exprs <span class="op">%&gt;%</span><span class="st"> </span>head</code></pre></div>
<pre><code>##              A          B
## X1   1797.4628  5794.4197
## X10   769.6681   826.6388
## X11 30516.1917 29366.5078
## X12 32763.7954 37451.2196
## X13 27910.6161 28495.8100
## X14  6341.1393  6670.0603</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Grouping by features and samples
msnset <span class="op">%&gt;%</span>
<span class="st">   </span><span class="kw">group_by</span>(charge) <span class="op">%&gt;%</span>
<span class="st">   </span><span class="kw">summarise</span>(<span class="kw">mean</span>(exprs)) <span class="op">%&gt;%</span>
<span class="st">   </span><span class="kw">group_by</span>(group) <span class="op">%&gt;%</span>
<span class="st">   </span><span class="kw">summarise</span>(<span class="kw">max</span>(exprs, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span>
<span class="st">   </span>exprs</code></pre></div>
<pre><code>##          A         B
## 2 13880.38 12660.236
## 3  1477.78  1346.071</code></pre>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li>
<a href="#examples">Examples</a><ul class="nav nav-pills nav-stacked">
<li><a href="#order-data-by-it-feature-of-sample-variables">Order data by it feature of sample variables</a></li>
      <li><a href="#return-features-and-samples-with-matching-conditions">Return features and samples with matching conditions</a></li>
      <li><a href="#group-by-one-or-more-feature-or-sample-variables">Group by one or more feature or sample variables</a></li>
      <li><a href="#select-feature-or-sample-variables">Select feature or sample variables</a></li>
      <li><a href="#summarise-the-expression-values-of-a-dataset">Summarise the expression values of a dataset</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Laurent Gatto.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
