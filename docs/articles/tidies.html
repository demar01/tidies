<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A Grammar of Data Manipulation for Omics Experiments • tidies</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">tidies</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/lgatto/tidies">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>A Grammar of Data Manipulation for Omics Experiments</h1>
                        <h4 class="author">Laurent Gatto</h4>
            
          </div>

    
    
<div class="contents">
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The <code>tidies</code> package (from to contraction of <em>tidy</em> <code>eSet</code>) implements tidy principles as defined in the <a href="https://www.tidyverse.org/">tidyverse</a> packages to omics-type data based on the <code>eSet</code> class, with (currently at least for now), an emphasis on quantitative proteomics data.</p>
<div id="high-throughput-data-and-the-eset-class" class="section level2">
<h2 class="hasAnchor">
<a href="#high-throughput-data-and-the-eset-class" class="anchor"></a>High throughput data and the <code>eSet</code> class</h2>
<p>The motivation to store omics data in dedicated containers is to coordinate the high throughput data (e.g., gene or protein expression), the sample annotation (phenotype data) and the feature annotation (feature data).</p>
<p>A typical omics data structure, as defined by the <a href="https://bioconductor.org/packages/release/bioc/vignettes/Biobase/inst/doc/BiobaseDevelopment.pdf"><code>eSet</code></a> class, is represented below. It’s main features are</p>
<ul>
<li><p>An assay data slot containing the quantitative omics data (expression data), stored as a <code>matrix</code> and accessible with <code>exprs</code>. Features defined along the rows and samples along the columns.</p></li>
<li><p>A sample metadata slot containing sample co-variates, stored as an annotated <code>data.frame</code> and accessible with <code>pData</code>. This data frame is stored with rows representing samples and sample covariate along the columns, and its rows match the expression data columns exactly.</p></li>
<li><p>A feature metadata slot containing feature co-variates, stored as an annotated <code>data.frame</code> and accessible with <code>fData</code>. This dataframe’s rows match the expression data rows exactly.</p></li>
</ul>
<div class="figure">
<img src="msnset.png" alt="A typical omics data object"><p class="caption">A typical omics data object</p>
</div>
<p>The coordinated nature of the high throughput data guarantees that the dimensions of the different slots will always match (i.e the columns in the expression data and then rows in the sample metadata, as well as the rows in the expression data and feature metadata) during data manipulation. The metadata slots can grow additional co-variates (columns) without affecting the other structures.</p>
<p>To illustrate such an omics data container, we’ll make use of the <code>msnset</code> object that comes with the <em><a href="http://bioconductor.org/packages/MSnbase">MSnbase</a></em> package, which contains data for 55 features and 4 samples.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"MSnbase"</span>)
<span class="kw">data</span>(msnset)

## Some test sample groups
msnset<span class="op">$</span>group &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>)
<span class="kw">dim</span>(msnset)</code></pre></div>
<pre><code>## [1] 55  4</code></pre>
<p>The expression data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">exprs</span>(msnset)</code></pre></div>
<pre><code>##       iTRAQ4.114  iTRAQ4.115  iTRAQ4.116  iTRAQ4.117
## X1    1347.61584  2247.30975  3927.69307  7661.14628
## X10    739.98608   799.35012   712.59830   940.67930
## X11  27638.35819 33394.02524 32104.28786 26628.72776
## X12  31892.89279 33634.69801 37674.72721 37227.71193
## X13  26143.75416 29677.47813 29089.05931 27902.56076
## X14   6448.08287  6234.19568  6902.89029  6437.23029
## X15    722.29818  1058.87116   851.47016   944.62868
## X16  10154.95328 10486.94267 11018.19118 11289.55202
## X17   2800.39559  3244.97754  2965.31877  3184.19386
## X18   4458.77171  4786.51826  4350.78472  4303.02563
## X19  32838.04395 37066.05777 41429.62671 39700.47518
## X2    3715.08932  4254.32256  4748.46152  5249.90356
## X20  34509.68621 34928.74712 41911.03212 42843.83865
## X21  21262.14754 23168.72913 25407.06847 25949.95404
## X22   8635.31649 10036.52908  9254.43168  7769.74907
## X23   1566.74773  1444.27953  1455.89659  1557.19896
## X24   1101.06205  1124.16708  1140.09311  1191.80548
## X25   5135.56011  5519.05329  5828.37084  5583.72953
## X26   1524.14767  1399.89688  1547.21848  1563.22990
## X27 147093.25030 94770.28613 42616.07457 21259.42497
## X28  30047.24363 31498.21764 38489.80882 38275.26375
## X29   9339.07912 10509.31520 10824.73863  9504.38777
## X3    4483.31990  4873.99606  6743.44063  4601.37758
## X30   1147.03795  1281.25856  1278.70097  1175.08044
## X31  12682.55301 13586.68865 13579.17358 13067.36481
## X32    508.17713   606.32085   725.66638   654.20259
## X33    760.03204   866.44037   883.90995   791.32963
## X34    658.83542   696.76216   603.12820   492.63404
## X35   3086.44981  3266.41942  4093.80327  3905.62406
## X36   2278.36612  2570.08001  2785.56562  2446.79895
## X37   1259.18898  1448.37341  1653.74896  1261.52449
## X38  11468.80365 12273.93798 12338.65631 11686.38167
## X39    982.40174  1119.31558   880.69916  1100.37213
## X4    1918.08242  1418.03978  1117.60113  1581.95396
## X40   2052.00113  2582.21183  1918.57369  2258.36892
## X41  17593.54759 18545.61972 19361.83670 18328.23650
## X42   5852.66544  5964.39464  5970.36943  6006.85932
## X43    872.45566   956.10275  1310.23148  1297.82407
## X44   1157.48743   952.06210  1178.14071   899.01924
## X45   1932.12004  2161.24030  2327.27156  2115.24632
## X46   5369.73246  1148.32171          NA  1313.44599
## X47   7384.83022  3935.30012  2370.02527  1115.75006
## X48    796.22002   669.10772   979.78007   855.39249
## X49   8504.48167  9924.07051 10058.26597  9611.86446
## X5   15210.97924 15296.25571 15592.76007 16550.50179
## X50   1400.19902  1300.18250  1492.60564  1490.85191
## X51   7540.63726  7679.15758  7561.98334  8005.17654
## X52   1593.43572  2927.41128  5028.29190 10362.14077
## X53    184.67577   207.80235   515.05578   865.38161
## X54   2092.47631  1993.87954  2371.34244  2620.85663
## X55     15.11764    15.68074    14.23333    14.03018
## X6    4133.10269  5069.98262  4724.84489  4694.80139
## X7   11947.88077 13061.87498 12809.49141 12911.47853
## X8    2770.37694  2907.22208  3055.51653  2946.79966
## X9    3824.35623  3746.26739  4285.02115  3649.44422</code></pre>
<p>The sample metadata:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pData</span>(msnset)</code></pre></div>
<pre><code>##               mz reporters group
## iTRAQ4.114 114.1    iTRAQ4     A
## iTRAQ4.115 115.1    iTRAQ4     A
## iTRAQ4.116 116.1    iTRAQ4     B
## iTRAQ4.117 117.1    iTRAQ4     B</code></pre>
<p>The feature metadata:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fData</span>(msnset)[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</code></pre></div>
<pre><code>##     spectrum ProteinAccession                       ProteinDescription
## X1         1              BSA                     bovine serum albumin
## X10       10          ECA1422 glucose-1-phosphate cytidylyltransferase
## X11       11          ECA4030         50S ribosomal subunit protein L4
## X12       12          ECA3882                   chaperone protein DnaK
## X13       13          ECA1364      succinyl-CoA synthetase alpha chain
## X14       14          ECA0871              NADP-dependent malic enzyme
## X15       15          ECA4512                  ATP synthase beta chain
## X16       16          ECA4513                 ATP synthase gamma chain
## X17       17          ECA3969  fumarate reductase flavoprotein subunit
## X18       18          ECA3082            malate:quinone oxidoreductase
##       PeptideSequence file
## X1             NYQEAK    1
## X10   VTLVDTGEHSMTGGR    1
## X11             SPIWR    1
## X12          TAIDDALK    1
## X13            SILINK    1
## X14      DFEVVNNESDPR    1
## X15 EGNDFYHEMTDSNVIDK    1
## X16        VMLQAYDEGR    1
## X17     ANAVVLATGGAGR    1
## X18         VATPEWQSK    1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## all feature variables
<span class="kw">fvarLabels</span>(msnset)</code></pre></div>
<pre><code>##  [1] "spectrum"            "ProteinAccession"    "ProteinDescription" 
##  [4] "PeptideSequence"     "file"                "retention.time"     
##  [7] "precursor.mz"        "precursor.intensity" "charge"             
## [10] "peaks.count"         "tic"                 "ionCount"           
## [13] "ms.level"            "acquisition.number"  "collision.energy"</code></pre>
</div>
<div id="tidy-tools" class="section level2">
<h2 class="hasAnchor">
<a href="#tidy-tools" class="anchor"></a>Tidy tools</h2>
<p>The <a href="https://www.jstatsoft.org/article/view/v059i10"><em>tidy data</em></a> definition and <a href="http://tidyverse.tidyverse.org/articles/manifesto.html">tidy tools manifesto</a> and lay out the principles that packages in the tidyverse package. <code>tidies</code> isn’t part of the this <code>tidyvers</code>, but aims at applying these same principles. The concepts that are relevant for the application to omics data are</p>
<ul>
<li><p>Reuse of existing data structures; in this case <code>eSet</code> objects, that constitute our <em>tidy</em> omics data.</p></li>
<li><p>Compose simple functions with the pipe; here we apply the widely used <em><a href="https://CRAN.R-project.org/package=dplyr">dplyr</a></em> functions and <em><a href="https://CRAN.R-project.org/package=magrittr">magrittr</a></em> <code>%&gt;%</code> operator.</p></li>
<li><p>Each of the adapted tidy function to use and return tidy <code>eSet</code> data.</p></li>
</ul>
</div>
<div id="the-tidies-package" class="section level2">
<h2 class="hasAnchor">
<a href="#the-tidies-package" class="anchor"></a>The <code>tidies</code> package</h2>
<p>The goal of this package is to support the <code>dplyr</code> function such as <code>select</code>, <code>filter</code>, <code>group_by</code>, <code>summarise</code>, … direcly on omics data containers described above. The function act on the respective variable and expression slots and preserve the object’s class.</p>
<p>Another approach is to convert the omics objects to tidy <code>tibbles</code> and work direcly with these. This can easily be done with the Bioconductor <em><a href="http://bioconductor.org/packages/biobroom">biobroom</a></em> package, that will convert the 55 features by 4 samples into a 220 tibble:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"biobroom"</span>)</code></pre></div>
<pre><code>## Loading required package: broom</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tidy</span>(msnset, <span class="dt">addPheno =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## # A tibble: 220 x 6
##    protein sample        mz reporters group  value
##    &lt;fct&gt;   &lt;fct&gt;      &lt;dbl&gt; &lt;fct&gt;     &lt;chr&gt;  &lt;dbl&gt;
##  1 X1      iTRAQ4.114  114. iTRAQ4    A      1348.
##  2 X10     iTRAQ4.114  114. iTRAQ4    A       740.
##  3 X11     iTRAQ4.114  114. iTRAQ4    A     27638.
##  4 X12     iTRAQ4.114  114. iTRAQ4    A     31893.
##  5 X13     iTRAQ4.114  114. iTRAQ4    A     26144.
##  6 X14     iTRAQ4.114  114. iTRAQ4    A      6448.
##  7 X15     iTRAQ4.114  114. iTRAQ4    A       722.
##  8 X16     iTRAQ4.114  114. iTRAQ4    A     10155.
##  9 X17     iTRAQ4.114  114. iTRAQ4    A      2800.
## 10 X18     iTRAQ4.114  114. iTRAQ4    A      4459.
## # ... with 210 more rows</code></pre>
</div>
</div>
<div id="examples" class="section level1">
<h1 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h1>
<p>We start by loading the <code>tidies</code> package (which also automatically loads and attaches <em><a href="https://CRAN.R-project.org/package=magrittr">magrittr</a></em> for the <code>%&gt;%</code> operator).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"tidies"</span>)</code></pre></div>
<div id="select-feature-or-sample-variables" class="section level2">
<h2 class="hasAnchor">
<a href="#select-feature-or-sample-variables" class="anchor"></a>Select feature or sample variables</h2>
<p>Select sample variables (updates only the phenotypic data)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">msnset <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">select</span>(group) <span class="op">%&gt;%</span>
<span class="st">    </span>pData</code></pre></div>
<pre><code>##            group
## iTRAQ4.114     A
## iTRAQ4.115     A
## iTRAQ4.116     B
## iTRAQ4.117     B</code></pre>
<p>Select feature variables (updates only the feature data)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## All feature variables
<span class="kw">fvarLabels</span>(msnset)</code></pre></div>
<pre><code>##  [1] "spectrum"            "ProteinAccession"    "ProteinDescription" 
##  [4] "PeptideSequence"     "file"                "retention.time"     
##  [7] "precursor.mz"        "precursor.intensity" "charge"             
## [10] "peaks.count"         "tic"                 "ionCount"           
## [13] "ms.level"            "acquisition.number"  "collision.energy"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Select a feature variable
msnset <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">select</span>(charge) <span class="op">%&gt;%</span>
<span class="st">    </span>fvarLabels</code></pre></div>
<pre><code>## [1] "charge"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Select features using a pattern
msnset <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">"Protein"</span>)) <span class="op">%&gt;%</span>
<span class="st">    </span>fvarLabels</code></pre></div>
<pre><code>## [1] "ProteinAccession"   "ProteinDescription"</code></pre>
<p>Select sample and feature variables</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">msnset <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">select</span>(group) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">"Prot"</span>))</code></pre></div>
<pre><code>## MSnSet (storageMode: lockedEnvironment)
## assayData: 55 features, 4 samples 
##   element names: exprs 
## protocolData: none
## phenoData
##   sampleNames: iTRAQ4.114 iTRAQ4.115 iTRAQ4.116 iTRAQ4.117
##   varLabels: group
##   varMetadata: labelDescription
## featureData
##   featureNames: X1 X10 ... X9 (55 total)
##   fvarLabels: ProteinAccession ProteinDescription
##   fvarMetadata: labelDescription
## experimentData: use 'experimentData(object)'
## Annotation: No annotation 
## - - - Processing information - - -
## Data loaded: Wed May 11 18:54:39 2011 
## iTRAQ4 quantification by trapezoidation: Wed Apr  1 21:41:53 2015 
##  MSnbase version: 1.1.22</code></pre>
</div>
<div id="order-data-by-it-feature-of-sample-variables" class="section level2">
<h2 class="hasAnchor">
<a href="#order-data-by-it-feature-of-sample-variables" class="anchor"></a>Order data by it feature of sample variables</h2>
<p>Arrange columns/samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">msnset <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">arrange</span>(<span class="kw">desc</span>(group)) <span class="op">%&gt;%</span>
<span class="st">    </span>pData</code></pre></div>
<pre><code>##               mz reporters group
## iTRAQ4.116 116.1    iTRAQ4     B
## iTRAQ4.117 117.1    iTRAQ4     B
## iTRAQ4.114 114.1    iTRAQ4     A
## iTRAQ4.115 115.1    iTRAQ4     A</code></pre>
<p>Arrange rows/features and select feature variables</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">msnset <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">arrange</span>(charge) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">select</span>(charge) <span class="op">%&gt;%</span>
<span class="st">    </span>fData <span class="op">%&gt;%</span><span class="st"> </span>head</code></pre></div>
<pre><code>##     charge
## X1       2
## X11      2
## X12      2
## X13      2
## X14      2
## X16      2</code></pre>
</div>
<div id="return-features-and-samples-with-matching-conditions" class="section level2">
<h2 class="hasAnchor">
<a href="#return-features-and-samples-with-matching-conditions" class="anchor"></a>Return features and samples with matching conditions</h2>
<p>Filter using feature variables</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">msnset <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter</span>(ProteinAccession <span class="op">==</span><span class="st"> "ENO"</span>) <span class="op">%&gt;%</span>
<span class="st">    </span>exprs</code></pre></div>
<pre><code>##       iTRAQ4.114  iTRAQ4.115  iTRAQ4.116  iTRAQ4.117
## X27 147093.25030 94770.28613 42616.07457 21259.42497
## X46   5369.73246  1148.32171          NA  1313.44599
## X47   7384.83022  3935.30012  2370.02527  1115.75006
## X55     15.11764    15.68074    14.23333    14.03018</code></pre>
<p>Filter using phenotypic (samples) variables</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">msnset <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter</span>(group <span class="op">==</span><span class="st"> "A"</span>) <span class="op">%&gt;%</span>
<span class="st">    </span>exprs <span class="op">%&gt;%</span>
<span class="st">    </span>head</code></pre></div>
<pre><code>##     iTRAQ4.114 iTRAQ4.115
## X1   1347.6158  2247.3097
## X10   739.9861   799.3501
## X11 27638.3582 33394.0252
## X12 31892.8928 33634.6980
## X13 26143.7542 29677.4781
## X14  6448.0829  6234.1957</code></pre>
<p>Filter on both feature and sample variables</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">msnset <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter</span>(group <span class="op">==</span><span class="st"> "A"</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter</span>(ProteinAccession <span class="op">==</span><span class="st"> "ENO"</span>) <span class="op">%&gt;%</span>
<span class="st">    </span>exprs</code></pre></div>
<pre><code>##       iTRAQ4.114  iTRAQ4.115
## X27 147093.25030 94770.28613
## X46   5369.73246  1148.32171
## X47   7384.83022  3935.30012
## X55     15.11764    15.68074</code></pre>
</div>
<div id="group-by-one-or-more-feature-or-sample-variables" class="section level2">
<h2 class="hasAnchor">
<a href="#group-by-one-or-more-feature-or-sample-variables" class="anchor"></a>Group by one or more feature or sample variables</h2>
<p>Group by features</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">msnset <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(ProteinAccession) <span class="op">%&gt;%</span>
<span class="st">    </span>show</code></pre></div>
<pre><code>## Grouped_eSet (storageMode: lockedEnvironment)
## assayData: 55 features, 4 samples 
##   element names: exprs 
## protocolData: none
## phenoData
##   sampleNames: iTRAQ4.114 iTRAQ4.115 iTRAQ4.116 iTRAQ4.117
##   varLabels: mz reporters group
##   varMetadata: labelDescription
## featureData
##   featureNames: X1 X10 ... X9 (55 total)
##   fvarLabels: spectrum ProteinAccession ... collision.energy (15
##     total)
##   fvarMetadata: labelDescription
## experimentData: use 'experimentData(object)'
## Annotation: No annotation 
## - - - Processing information - - -
## Data loaded: Wed May 11 18:54:39 2011 
## iTRAQ4 quantification by trapezoidation: Wed Apr  1 21:41:53 2015 
##  MSnbase version: 1.1.22 
## Groups:
##   features  ProteinAccession [ 40 ]
##   samples    [ 0 ]</code></pre>
<p>Group by samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">msnset <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(group) <span class="op">%&gt;%</span>
<span class="st">    </span>show</code></pre></div>
<pre><code>## Grouped_eSet (storageMode: lockedEnvironment)
## assayData: 55 features, 4 samples 
##   element names: exprs 
## protocolData: none
## phenoData
##   sampleNames: iTRAQ4.114 iTRAQ4.115 iTRAQ4.116 iTRAQ4.117
##   varLabels: mz reporters group
##   varMetadata: labelDescription
## featureData
##   featureNames: X1 X10 ... X9 (55 total)
##   fvarLabels: spectrum ProteinAccession ... collision.energy (15
##     total)
##   fvarMetadata: labelDescription
## experimentData: use 'experimentData(object)'
## Annotation: No annotation 
## - - - Processing information - - -
## Data loaded: Wed May 11 18:54:39 2011 
## iTRAQ4 quantification by trapezoidation: Wed Apr  1 21:41:53 2015 
##  MSnbase version: 1.1.22 
## Groups:
##   features   [ 0 ]
##   samples   group [ 2 ]</code></pre>
<p>Group by features and samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">msnset <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(ProteinAccession) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(group) <span class="op">%&gt;%</span>
<span class="st">    </span>show</code></pre></div>
<pre><code>## Grouped_eSet (storageMode: lockedEnvironment)
## assayData: 55 features, 4 samples 
##   element names: exprs 
## protocolData: none
## phenoData
##   sampleNames: iTRAQ4.114 iTRAQ4.115 iTRAQ4.116 iTRAQ4.117
##   varLabels: mz reporters group
##   varMetadata: labelDescription
## featureData
##   featureNames: X1 X10 ... X9 (55 total)
##   fvarLabels: spectrum ProteinAccession ... collision.energy (15
##     total)
##   fvarMetadata: labelDescription
## experimentData: use 'experimentData(object)'
## Annotation: No annotation 
## - - - Processing information - - -
## Data loaded: Wed May 11 18:54:39 2011 
## iTRAQ4 quantification by trapezoidation: Wed Apr  1 21:41:53 2015 
##  MSnbase version: 1.1.22 
## Groups:
##   features  ProteinAccession [ 40 ]
##   samples   group [ 2 ]</code></pre>
</div>
<div id="summarise-the-expression-values-of-a-dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#summarise-the-expression-values-of-a-dataset" class="anchor"></a>Summarise the expression values of a dataset</h2>
<p>Grouping and summarising by features</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">msnset <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(charge) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">summarise</span>(<span class="kw">median</span>(exprs, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span>
<span class="st">    </span>exprs</code></pre></div>
<pre><code>##   iTRAQ4.114 iTRAQ4.115 iTRAQ4.116 iTRAQ4.117
## 2  6916.4565   6099.295   6436.630   7715.448
## 3   982.4017   1119.316   1048.691   1175.080</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">msnset <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(ProteinAccession) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">summarise</span>(<span class="kw">median</span>(exprs, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span>
<span class="st">    </span>exprs <span class="op">%&gt;%</span>
<span class="st">    </span>head</code></pre></div>
<pre><code>##         iTRAQ4.114 iTRAQ4.115 iTRAQ4.116 iTRAQ4.117
## BSA       1347.616   2247.310   3927.693  7661.1463
## ECA0172  17593.548  18545.620  19361.837 18328.2365
## ECA0435   4923.628   5557.818   5775.203  5079.2952
## ECA0452   1524.148   1399.897   1547.218  1563.2299
## ECA0469   1069.945   1035.689   1029.420   999.6957
## ECA0621   1101.062   1124.167   1140.093  1191.8055</code></pre>
<p>Grouping and summarising by samples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">msnset <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(group) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">summarise</span>(<span class="kw">mean</span>(exprs, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span>
<span class="st">    </span>exprs <span class="op">%&gt;%</span>
<span class="st">    </span>head</code></pre></div>
<pre><code>##              A          B
## X1   1797.4628  5794.4197
## X10   769.6681   826.6388
## X11 30516.1917 29366.5078
## X12 32763.7954 37451.2196
## X13 27910.6161 28495.8100
## X14  6341.1393  6670.0603</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Grouping by features and samples
msnset <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(charge) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">summarise</span>(<span class="kw">mean</span>(exprs)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(group) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">summarise</span>(<span class="kw">max</span>(exprs, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span>
<span class="st">    </span>exprs</code></pre></div>
<pre><code>##          A         B
## 2 13880.38 12660.236
## 3  1477.78  1346.071</code></pre>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#introduction">Introduction</a><ul class="nav nav-pills nav-stacked">
<li><a href="#high-throughput-data-and-the-eset-class">High throughput data and the <code>eSet</code> class</a></li>
      <li><a href="#tidy-tools">Tidy tools</a></li>
      <li><a href="#the-tidies-package">The <code>tidies</code> package</a></li>
      </ul>
</li>
      <li>
<a href="#examples">Examples</a><ul class="nav nav-pills nav-stacked">
<li><a href="#select-feature-or-sample-variables">Select feature or sample variables</a></li>
      <li><a href="#order-data-by-it-feature-of-sample-variables">Order data by it feature of sample variables</a></li>
      <li><a href="#return-features-and-samples-with-matching-conditions">Return features and samples with matching conditions</a></li>
      <li><a href="#group-by-one-or-more-feature-or-sample-variables">Group by one or more feature or sample variables</a></li>
      <li><a href="#summarise-the-expression-values-of-a-dataset">Summarise the expression values of a dataset</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Laurent Gatto.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
